(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var Point = (function () {
    function Point(x, y) {
        this.x = x;
        this.y = y;
    }
    Point.prototype.add = function (point) {
        this.x += point.x;
        this.y += point.y;
    };
    return Point;
}());
var Side;
(function (Side) {
    Side[Side["None"] = 0] = "None";
    Side[Side["Left"] = 1] = "Left";
    Side[Side["Top"] = 2] = "Top";
    Side[Side["Right"] = 3] = "Right";
    Side[Side["Bottom"] = 4] = "Bottom";
})(Side || (Side = {}));
var Rect = (function () {
    function Rect(left, top, right, bottom) {
        this.topLeft = new Point(left, top);
        this.bottomRight = new Point(right, bottom);
    }
    Rect.prototype.clone = function () {
        return new Rect(this.topLeft.x, this.topLeft.y, this.bottomRight.x, this.bottomRight.y);
    };
    Rect.prototype.add = function (point) {
        this.topLeft.add(point);
        this.bottomRight.add(point);
    };
    Rect.prototype.moveTo = function (rect) {
        this.topLeft.x = rect.topLeft.x;
        this.topLeft.y = rect.topLeft.y;
        this.bottomRight.x = rect.bottomRight.x;
        this.bottomRight.y = rect.bottomRight.y;
    };
    Rect.prototype.moveCenterXTo = function (centerX) {
        var left = centerX - this.width() / 2;
        var right = left + this.width();
        this.topLeft.x = left;
        this.bottomRight.x = right;
    };
    Rect.prototype.moveBottomTo = function (bottom) {
        this.topLeft.y = bottom - this.height();
        this.bottomRight.y = bottom;
    };
    Rect.prototype.width = function () {
        return this.bottomRight.x - this.topLeft.x;
    };
    Rect.prototype.height = function () {
        return this.bottomRight.y - this.topLeft.y;
    };
    Rect.prototype.centerX = function () {
        return (this.topLeft.x + this.bottomRight.x) / 2;
    };
    Rect.prototype.centerY = function () {
        return (this.topLeft.y + this.bottomRight.y) / 2;
    };
    Rect.prototype.moveLeft = function (step) {
        this.topLeft.x -= step;
        this.bottomRight.x -= step;
    };
    Rect.prototype.moveRight = function (step) {
        this.topLeft.x += step;
        this.bottomRight.x += step;
    };
    return Rect;
}());
var Obstacle = (function (_super) {
    __extends(Obstacle, _super);
    function Obstacle() {
        _super.apply(this, arguments);
    }
    Obstacle.prototype.checkCollision = function (anotherRect) {
        var w = 0.5 * (this.width() + anotherRect.width());
        var h = 0.5 * (this.height() + anotherRect.height());
        var dx = this.centerX() - anotherRect.centerX();
        var dy = this.centerY() - anotherRect.centerY();
        if (Math.abs(dx) <= w && Math.abs(dy) <= h) {
            var wy = w * dy;
            var hx = h * dx;
            if (wy > hx) {
                return wy > -hx ? Side.Top : Side.Left;
            }
            else {
                return wy > -hx ? Side.Right : Side.Bottom;
            }
        }
        else {
            return Side.None;
        }
    };
    return Obstacle;
}(Rect));
var Vector = (function (_super) {
    __extends(Vector, _super);
    function Vector() {
        _super.apply(this, arguments);
    }
    Vector.prototype.flipX = function () {
        this.x *= -1;
    };
    Vector.prototype.flipY = function () {
        this.y *= -1;
    };
    return Vector;
}(Point));
var Sprite = (function (_super) {
    __extends(Sprite, _super);
    function Sprite(sprite, left, top, right, bottom) {
        bottom = bottom || sprite.offsetTop + sprite.offsetHeight;
        right = right || sprite.offsetLeft + sprite.offsetWidth;
        top = top || sprite.offsetTop;
        left = left || sprite.offsetLeft;
        _super.call(this, left, top, right, bottom);
        this.sprite = sprite;
        this.isVisible = true;
    }
    Sprite.prototype.moveTo = function (rect) {
        _super.prototype.moveTo.call(this, rect);
        var _a = this.topLeft, posX = _a.x, posY = _a.y;
        this.sprite.style.left = posX + 'px';
        this.sprite.style.top = posY + 'px';
    };
    Sprite.prototype.hide = function () {
        this.sprite.style.display = 'none';
        this.isVisible = false;
    };
    Sprite.prototype.show = function () {
        this.sprite.style.display = 'block';
        this.isVisible = true;
    };
    Sprite.prototype.checkCollision = function (anotherRect) {
        if (!this.isVisible) {
            return Side.None;
        }
        return _super.prototype.checkCollision.call(this, anotherRect);
    };
    return Sprite;
}(Obstacle));
var Brick = (function (_super) {
    __extends(Brick, _super);
    function Brick() {
        _super.apply(this, arguments);
    }
    return Brick;
}(Sprite));
var Paddle = (function (_super) {
    __extends(Paddle, _super);
    function Paddle(sprite, maxRight) {
        _super.call(this, sprite);
        this.maxRight = maxRight;
    }
    Paddle.prototype.moveLeft = function (step) {
        var newPosition = this.clone();
        newPosition.moveLeft(step);
        if (newPosition.topLeft.x >= 0) {
            this.moveTo(newPosition);
        }
    };
    Paddle.prototype.moveRight = function (step) {
        var newPosition = this.clone();
        newPosition.moveRight(step);
        if (newPosition.bottomRight.x <= this.maxRight) {
            this.moveTo(newPosition);
        }
    };
    Paddle.prototype.calculateHitAngle = function (ballX, ballRadius) {
        var hitSpot = ballX - this.topLeft.x;
        var maxPaddle = this.width() + ballRadius;
        var minPaddle = -ballRadius;
        var paddleRange = maxPaddle - minPaddle;
        var minAngle = 160;
        var maxAngle = 20;
        var angleRange = maxAngle - minAngle;
        return ((hitSpot * angleRange) / paddleRange) + minAngle;
    };
    return Paddle;
}(Sprite));
var Ball = (function (_super) {
    __extends(Ball, _super);
    function Ball(sprite, dir) {
        var radius = parseInt(getComputedStyle(sprite)['border-top-left-radius']);
        _super.call(this, sprite, sprite.offsetLeft, sprite.offsetTop, sprite.offsetLeft + 2 * radius, sprite.offsetTop + 2 * radius);
        this.sprite = sprite;
        this.radius = radius;
        this.velocity = 5;
        this.dir = dir;
    }
    Ball.prototype.calculateNewPosition = function () {
        var newPosition = this.clone();
        newPosition.add(this.dir);
        return newPosition;
    };
    Ball.prototype.bounceHorizontal = function () {
        this.dir.flipY();
    };
    Ball.prototype.bounceVertical = function () {
        this.dir.flipX();
    };
    Ball.prototype.bounceWithAngle = function (angle) {
        angle = angle * (Math.PI / 180);
        this.dir.x = Math.cos(angle) * this.velocity;
        this.dir.y = -Math.sin(angle) * this.velocity;
    };
    return Ball;
}(Sprite));
var GameState;
(function (GameState) {
    GameState[GameState["Running"] = 0] = "Running";
    GameState[GameState["GameOver"] = 1] = "GameOver";
})(GameState || (GameState = {}));
var KeyCodes;
(function (KeyCodes) {
    KeyCodes[KeyCodes["LEFT"] = 37] = "LEFT";
    KeyCodes[KeyCodes["RIGHT"] = 39] = "RIGHT";
})(KeyCodes || (KeyCodes = {}));
var Game = (function () {
    function Game(ballElement, paddle, bricks, boardElement, livesLabel, scoreLabel, newGameBtn) {
        var _this = this;
        this.livesLabel = livesLabel;
        this.scoreLabel = scoreLabel;
        this.newGameBtn = newGameBtn;
        this.loopInterval = 10;
        this.bricks = [];
        this.keyMap = {};
        this.gameState = GameState.Running;
        this.paddle = new Paddle(paddle, boardElement.offsetWidth);
        this.ball = new Ball(ballElement, new Vector(3, -3));
        for (var i = 0; i < bricks.length; i++) {
            this.bricks.push(new Brick(bricks[i]));
        }
        this.createWalls(this.ball.radius, boardElement.offsetWidth, boardElement.offsetHeight);
        this.newGame();
        this.newGameBtn.addEventListener('click', function () { return _this.newGame(); });
    }
    Game.prototype.createWalls = function (radius, maxX, maxY) {
        this.wallLeft = new Obstacle(-radius, -radius, 0, maxY + radius);
        this.wallTop = new Obstacle(-radius, -radius, maxX + radius, 0);
        this.wallRight = new Obstacle(maxX, -radius, maxX + radius, maxY + radius);
        this.wallBottom = new Obstacle(-radius, maxY, maxX + radius, maxY + radius);
    };
    Game.prototype.newGame = function () {
        this.newGameBtn.style.display = 'none';
        this.score = 0;
        this.livesLeft = 3;
        this.livesLabel.innerText = '' + this.livesLeft;
        this.score = 0;
        this.scoreLabel.innerText = '' + this.score;
        this.ball.show();
        this.ball.bounceWithAngle(60);
        var ballPosition = this.ball.clone();
        ballPosition.moveCenterXTo(this.paddle.centerX());
        ballPosition.moveBottomTo(this.paddle.topLeft.y - 4);
        this.ball.moveTo(ballPosition);
        this.gameState = GameState.Running;
    };
    Game.prototype.lostLive = function () {
        if (--this.livesLeft) {
            this.ball.bounceWithAngle(60);
            var ballPosition = this.ball.clone();
            ballPosition.moveCenterXTo(this.paddle.centerX());
            ballPosition.moveBottomTo(this.paddle.topLeft.y - 4);
            this.ball.moveTo(ballPosition);
        }
        else {
            this.gameState = GameState.GameOver;
            this.ball.hide();
            this.newGameBtn.style.display = 'block';
        }
        this.livesLabel.innerText = '' + this.livesLeft;
    };
    Game.prototype.run = function () {
        var _this = this;
        document.addEventListener('keyup', function (e) { return _this.keyMap[e.keyCode] = false; });
        document.addEventListener('keydown', function (e) { return _this.keyMap[e.keyCode] = true; });
        setInterval(function () {
            if (_this.gameState !== GameState.Running) {
                return;
            }
            var newBallPosition = _this.ball.calculateNewPosition();
            if (_this.keyMap[KeyCodes.LEFT]) {
                _this.paddle.moveLeft(5);
            }
            else if (_this.keyMap[KeyCodes.RIGHT]) {
                _this.paddle.moveRight(5);
            }
            if (_this.wallBottom.checkCollision(newBallPosition)) {
                _this.lostLive();
                return;
            }
            if (_this.wallLeft.checkCollision(newBallPosition) || _this.wallRight.checkCollision(newBallPosition)) {
                _this.ball.bounceVertical();
            }
            if (_this.wallTop.checkCollision(newBallPosition)) {
                _this.ball.bounceHorizontal();
            }
            for (var _i = 0, _a = _this.bricks; _i < _a.length; _i++) {
                var brick = _a[_i];
                var wasHit = false;
                switch (brick.checkCollision(newBallPosition)) {
                    case (Side.Left):
                    case (Side.Right):
                        _this.ball.bounceVertical();
                        wasHit = true;
                        break;
                    case (Side.Top):
                    case (Side.Bottom):
                        _this.ball.bounceHorizontal();
                        wasHit = true;
                }
                if (wasHit) {
                    brick.hide();
                    _this.score += 20;
                    _this.scoreLabel.innerText = '' + _this.score;
                    break;
                }
            }
            if (_this.paddle.checkCollision(newBallPosition)) {
                _this.ball.bounceWithAngle(_this.paddle.calculateHitAngle(_this.ball.centerX(), _this.ball.radius));
            }
            _this.ball.moveTo(_this.ball.calculateNewPosition());
        }, this.loopInterval);
    };
    return Game;
}());
var game = new Game(document.getElementsByClassName("ball")[0], document.getElementsByClassName("paddle")[0], document.getElementsByClassName("brick"), document.getElementsByClassName("game-board")[0], document.getElementById('lives'), document.getElementById('score'), document.getElementById('newGame'));
game.run();

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHBsaWNhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0FDQUE7SUFHRyxlQUFZLENBQVMsRUFBRSxDQUFTO1FBQzlCLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1gsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDYixDQUFDO0lBRUQsbUJBQUcsR0FBSCxVQUFJLEtBQVk7UUFDZCxJQUFJLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDbEIsSUFBSSxDQUFDLENBQUMsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFBO0lBQ25CLENBQUM7SUFDSixZQUFDO0FBQUQsQ0FaQSxBQVlDLElBQUE7QUFFRCxJQUFLLElBTUo7QUFORCxXQUFLLElBQUk7SUFDUCwrQkFBSSxDQUFBO0lBQ0osK0JBQUksQ0FBQTtJQUNKLDZCQUFHLENBQUE7SUFDSCxpQ0FBSyxDQUFBO0lBQ0wsbUNBQU0sQ0FBQTtBQUNSLENBQUMsRUFOSSxJQUFJLEtBQUosSUFBSSxRQU1SO0FBRUQ7SUFJRSxjQUFZLElBQWEsRUFBRSxHQUFXLEVBQUUsS0FBYSxFQUFFLE1BQWM7UUFDbkUsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDcEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLEtBQUssQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDOUMsQ0FBQztJQUVELG9CQUFLLEdBQUw7UUFDRSxNQUFNLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMx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Q2hDLFFBQVEsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLEVBQ2hDLFFBQVEsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQ2hELENBQUM7QUFFRixJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjbGFzcyBQb2ludCB7XG4gICB4OiBudW1iZXI7XG4gICB5OiBudW1iZXI7XG4gICBjb25zdHJ1Y3Rvcih4OiBudW1iZXIsIHk6IG51bWJlcikge1xuICAgICB0aGlzLnggPSB4O1xuICAgICB0aGlzLnkgPSB5O1xuICAgfVxuXG4gICBhZGQocG9pbnQ6IFBvaW50KSB7XG4gICAgIHRoaXMueCArPSBwb2ludC54O1xuICAgICB0aGlzLnkgKz0gcG9pbnQueVxuICAgfVxufVxuXG5lbnVtIFNpZGUge1xuICBOb25lLFxuICBMZWZ0LFxuICBUb3AsXG4gIFJpZ2h0LCBcbiAgQm90dG9tXG59XG5cbmNsYXNzIFJlY3Qge1xuICB0b3BMZWZ0IDogUG9pbnQ7XG4gIGJvdHRvbVJpZ2h0IDogUG9pbnQ7XG5cbiAgY29uc3RydWN0b3IobGVmdCA6IG51bWJlciwgdG9wOiBudW1iZXIsIHJpZ2h0OiBudW1iZXIsIGJvdHRvbTogbnVtYmVyKSB7XG4gICAgdGhpcy50b3BMZWZ0ID0gbmV3IFBvaW50KGxlZnQsIHRvcCk7XG4gICAgdGhpcy5ib3R0b21SaWdodCA9IG5ldyBQb2ludChyaWdodCwgYm90dG9tKTtcbiAgfVxuXG4gIGNsb25lKCkgOiBSZWN0IHtcbiAgICByZXR1cm4gbmV3IFJlY3QodGhpcy50b3BMZWZ0LngsIHRoaXMudG9wTGVmdC55LCB0aGlzLmJvdHRvbVJpZ2h0LngsIHRoaXMuYm90dG9tUmlnaHQueSk7XG4gIH1cblxuICBhZGQocG9pbnQ6IFBvaW50KSB7XG4gICAgdGhpcy50b3BMZWZ0LmFkZChwb2ludCk7XG4gICAgdGhpcy5ib3R0b21SaWdodC5hZGQocG9pbnQpO1xuICB9XG5cbiAgbW92ZVRvKHJlY3Q6IFJlY3QpIHtcbiAgICB0aGlzLnRvcExlZnQueCA9IHJlY3QudG9wTGVmdC54O1xuICAgIHRoaXMudG9wTGVmdC55ID0gcmVjdC50b3BMZWZ0Lnk7XG4gICAgdGhpcy5ib3R0b21SaWdodC54ID0gcmVjdC5ib3R0b21SaWdodC54O1xuICAgIHRoaXMuYm90dG9tUmlnaHQueSA9IHJlY3QuYm90dG9tUmlnaHQueTtcbiAgfVxuXG4gIG1vdmVDZW50ZXJYVG8oY2VudGVyWCA6IG51bWJlcikge1xuICAgIHZhciBsZWZ0ID0gY2VudGVyWCAtIHRoaXMud2lkdGgoKSAvIDI7XG4gICAgdmFyIHJpZ2h0ID0gbGVmdCArIHRoaXMud2lkdGgoKTtcbiAgICB0aGlzLnRvcExlZnQueCA9IGxlZnQ7XG4gICAgdGhpcy5ib3R0b21SaWdodC54ID0gcmlnaHQ7XG4gIH1cblxuICBtb3ZlQm90dG9tVG8oYm90dG9tOiBudW1iZXIpIHtcbiAgICB0aGlzLnRvcExlZnQueSA9IGJvdHRvbSAtIHRoaXMuaGVpZ2h0KCk7XG4gICAgdGhpcy5ib3R0b21SaWdodC55ID0gYm90dG9tOyBcbiAgfVxuXG4gIHdpZHRoKCkge1xuICAgIHJldHVybiB0aGlzLmJvdHRvbVJpZ2h0LnggLSB0aGlzLnRvcExlZnQueDtcbiAgfVxuXG4gIGhlaWdodCgpIHtcbiAgICByZXR1cm4gdGhpcy5ib3R0b21SaWdodC55IC0gdGhpcy50b3BMZWZ0Lnk7XG4gIH1cblxuICBjZW50ZXJYKCkge1xuICAgIHJldHVybiAodGhpcy50b3BMZWZ0LnggKyB0aGlzLmJvdHRvbVJpZ2h0LngpIC8gMjtcbiAgfVxuXG4gIGNlbnRlclkoKSB7XG4gICAgcmV0dXJuICh0aGlzLnRvcExlZnQueSArIHRoaXMuYm90dG9tUmlnaHQueSkgLyAyO1xuICB9XG5cbiAgbW92ZUxlZnQoc3RlcDogbnVtYmVyKSB7XG4gICAgdGhpcy50b3BMZWZ0LnggLT0gc3RlcDtcbiAgICB0aGlzLmJvdHRvbVJpZ2h0LnggLT0gc3RlcDtcbiAgfVxuXG4gIG1vdmVSaWdodChzdGVwOiBudW1iZXIpIHtcbiAgICB0aGlzLnRvcExlZnQueCArPSBzdGVwO1xuICAgIHRoaXMuYm90dG9tUmlnaHQueCArPSBzdGVwO1xuICB9XG5cbn1cblxuY2xhc3MgT2JzdGFjbGUgZXh0ZW5kcyBSZWN0IHtcbiAgY2hlY2tDb2xsaXNpb24oYW5vdGhlclJlY3QgOiBSZWN0KSA6IFNpZGUge1xuICAgIHZhciB3ID0gMC41ICogKHRoaXMud2lkdGgoKSArIGFub3RoZXJSZWN0LndpZHRoKCkpO1xuICAgIHZhciBoID0gMC41ICogKHRoaXMuaGVpZ2h0KCkgKyBhbm90aGVyUmVjdC5oZWlnaHQoKSk7XG4gICAgdmFyIGR4ID0gdGhpcy5jZW50ZXJYKCkgLSBhbm90aGVyUmVjdC5jZW50ZXJYKCk7XG4gICAgdmFyIGR5ID0gdGhpcy5jZW50ZXJZKCkgLSBhbm90aGVyUmVjdC5jZW50ZXJZKCk7XG5cbiAgICBpZiAoTWF0aC5hYnMoZHgpIDw9IHcgJiYgTWF0aC5hYnMoZHkpIDw9IGgpIHtcbiAgICAgICAgdmFyIHd5ID0gdyAqIGR5O1xuICAgICAgICB2YXIgaHggPSBoICogZHg7XG4gICAgICAgIGlmICh3eSA+IGh4KSB7XG4gICAgICAgICAgICByZXR1cm4gd3kgPiAtaHggPyBTaWRlLlRvcCA6IFNpZGUuTGVmdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB3eSA+IC1oeCA/IFNpZGUuUmlnaHQgOiBTaWRlLkJvdHRvbTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBTaWRlLk5vbmU7XG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFZlY3RvciBleHRlbmRzIFBvaW50IHtcbiAgZmxpcFgoKSB7XG4gICAgdGhpcy54ICo9IC0xO1xuICB9XG5cbiAgZmxpcFkoKSB7XG4gICAgdGhpcy55ICo9IC0xO1xuICB9XG59XG5cbmNsYXNzIFNwcml0ZSBleHRlbmRzIE9ic3RhY2xlIHtcbiAgc3ByaXRlOiBIVE1MRWxlbWVudDtcbiAgaXNWaXNpYmxlOiBCb29sZWFuO1xuXG4gIGNvbnN0cnVjdG9yKHNwcml0ZTogSFRNTEVsZW1lbnQsIGxlZnQ/IDogbnVtYmVyLCB0b3A/OiBudW1iZXIsIHJpZ2h0PzogbnVtYmVyLCBib3R0b20/OiBudW1iZXIpIHtcbiAgICAgIGJvdHRvbSA9IGJvdHRvbSB8fCBzcHJpdGUub2Zmc2V0VG9wICsgc3ByaXRlLm9mZnNldEhlaWdodDtcbiAgICAgIHJpZ2h0ID0gcmlnaHQgfHwgc3ByaXRlLm9mZnNldExlZnQgKyBzcHJpdGUub2Zmc2V0V2lkdGg7XG4gICAgICB0b3AgPSB0b3AgfHwgc3ByaXRlLm9mZnNldFRvcDtcbiAgICAgIGxlZnQgPSBsZWZ0IHx8IHNwcml0ZS5vZmZzZXRMZWZ0O1xuXG4gICAgICBzdXBlcihsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pO1xuICAgICAgdGhpcy5zcHJpdGUgPSBzcHJpdGU7XG4gICAgICB0aGlzLmlzVmlzaWJsZSA9IHRydWU7XG4gIH1cblxuICBtb3ZlVG8ocmVjdCA6IFJlY3QpIHtcbiAgICBzdXBlci5tb3ZlVG8ocmVjdCk7XG5cbiAgICBsZXQge3g6IHBvc1gsIHk6IHBvc1l9ID0gdGhpcy50b3BMZWZ0O1xuXG4gICAgdGhpcy5zcHJpdGUuc3R5bGUubGVmdCA9IHBvc1ggKyAncHgnO1xuICAgIHRoaXMuc3ByaXRlLnN0eWxlLnRvcCA9IHBvc1kgKyAncHgnOyAgICAgICAgIFxuICB9XG5cbiAgaGlkZSgpIHtcbiAgICB0aGlzLnNwcml0ZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2U7XG4gIH0gICAgXG5cbiAgc2hvdygpIHtcbiAgICB0aGlzLnNwcml0ZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB0aGlzLmlzVmlzaWJsZSA9IHRydWU7XG4gIH0gICAgXG5cbiAgY2hlY2tDb2xsaXNpb24oYW5vdGhlclJlY3QgOiBSZWN0KSA6IFNpZGUge1xuICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHtcbiAgICAgICAgcmV0dXJuIFNpZGUuTm9uZTtcbiAgICB9XG4gICAgcmV0dXJuIHN1cGVyLmNoZWNrQ29sbGlzaW9uKGFub3RoZXJSZWN0KTtcbiAgfVxufVxuXG5cbmNsYXNzIEJyaWNrIGV4dGVuZHMgU3ByaXRlIHtcblxufVxuXG5jbGFzcyBQYWRkbGUgZXh0ZW5kcyBTcHJpdGUge1xuICBjb25zdHJ1Y3RvcihzcHJpdGU6IEhUTUxFbGVtZW50LCBwdWJsaWMgbWF4UmlnaHQgOiBudW1iZXIpIHtcbiAgICAgIHN1cGVyKHNwcml0ZSk7XG4gIH1cblxuICBtb3ZlTGVmdChzdGVwPzogbnVtYmVyKSB7XG4gICAgICB2YXIgbmV3UG9zaXRpb24gPSB0aGlzLmNsb25lKCk7XG4gICAgICBuZXdQb3NpdGlvbi5tb3ZlTGVmdChzdGVwKTtcblxuICAgICAgaWYgKG5ld1Bvc2l0aW9uLnRvcExlZnQueCA+PSAwKSB7XG4gICAgICAgICAgdGhpcy5tb3ZlVG8obmV3UG9zaXRpb24pO1xuICAgICAgfVxuICB9XG5cbiAgbW92ZVJpZ2h0KHN0ZXA/IDogbnVtYmVyKSB7XG4gICAgICB2YXIgbmV3UG9zaXRpb24gPSB0aGlzLmNsb25lKCk7XG4gICAgICBuZXdQb3NpdGlvbi5tb3ZlUmlnaHQoc3RlcCk7XG5cbiAgICAgIGlmIChuZXdQb3NpdGlvbi5ib3R0b21SaWdodC54IDw9IHRoaXMubWF4UmlnaHQpIHtcbiAgICAgICAgICB0aGlzLm1vdmVUbyhuZXdQb3NpdGlvbik7XG4gICAgICB9XG4gIH1cblxuICBjYWxjdWxhdGVIaXRBbmdsZShiYWxsWCA6IG51bWJlciwgYmFsbFJhZGl1cyA6IG51bWJlcikgOiBudW1iZXIge1xuICAgICAgdmFyIGhpdFNwb3QgPSBiYWxsWCAtIHRoaXMudG9wTGVmdC54O1xuICAgICAgdmFyIG1heFBhZGRsZSA9IHRoaXMud2lkdGgoKSArIGJhbGxSYWRpdXM7XG4gICAgICB2YXIgbWluUGFkZGxlID0gLWJhbGxSYWRpdXM7XG4gICAgICB2YXIgcGFkZGxlUmFuZ2UgPSBtYXhQYWRkbGUgLSBtaW5QYWRkbGU7XG5cbiAgICAgIHZhciBtaW5BbmdsZSA9IDE2MDtcbiAgICAgIHZhciBtYXhBbmdsZSA9IDIwO1xuICAgICAgdmFyIGFuZ2xlUmFuZ2UgPSBtYXhBbmdsZSAtIG1pbkFuZ2xlO1xuXG4gICAgICByZXR1cm4gKChoaXRTcG90ICogYW5nbGVSYW5nZSkgLyBwYWRkbGVSYW5nZSkgKyBtaW5BbmdsZTtcbiAgfVxufVxuXG5jbGFzcyBCYWxsIGV4dGVuZHMgU3ByaXRlIHtcbiAgcmFkaXVzIDogbnVtYmVyO1xuICBkaXIgIDogVmVjdG9yO1xuICB2ZWxvY2l0eTogbnVtYmVyO1xuXG4gIHdhbGxMZWZ0IDogT2JzdGFjbGU7XG4gIHdhbGxUb3A6IE9ic3RhY2xlO1xuICB3YWxsUmlnaHQ6IE9ic3RhY2xlO1xuICB3YWxsQm90dG9tOiBPYnN0YWNsZTtcblxuICBjb25zdHJ1Y3RvcihzcHJpdGU6IEhUTUxFbGVtZW50LCBkaXIgOiBWZWN0b3IpIHtcbiAgICB2YXIgcmFkaXVzID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShzcHJpdGUpWydib3JkZXItdG9wLWxlZnQtcmFkaXVzJ10pO1xuICAgIHN1cGVyKHNwcml0ZSwgc3ByaXRlLm9mZnNldExlZnQsIHNwcml0ZS5vZmZzZXRUb3AsIHNwcml0ZS5vZmZzZXRMZWZ0ICsgMiAqIHJhZGl1cywgc3ByaXRlLm9mZnNldFRvcCArIDIgKiByYWRpdXMpO1xuICAgIHRoaXMuc3ByaXRlID0gc3ByaXRlO1xuICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICAgIHRoaXMudmVsb2NpdHkgPSA1OyAgICAgICAgXG4gICAgdGhpcy5kaXIgPSBkaXI7ICAgICAgICBcbiAgfVxuXG4gIGNhbGN1bGF0ZU5ld1Bvc2l0aW9uKCkgOiBSZWN0IHtcbiAgICAgIHZhciBuZXdQb3NpdGlvbiA9IHRoaXMuY2xvbmUoKTtcbiAgICAgIG5ld1Bvc2l0aW9uLmFkZCh0aGlzLmRpcik7XG4gICAgICByZXR1cm4gbmV3UG9zaXRpb247ICAgICAgICBcbiAgfVxuXG4gIGJvdW5jZUhvcml6b250YWwoKSB7XG4gICAgICB0aGlzLmRpci5mbGlwWSgpO1xuICB9XG5cbiAgYm91bmNlVmVydGljYWwoKSB7XG4gICAgICB0aGlzLmRpci5mbGlwWCgpO1xuICB9IFxuXG4gIGJvdW5jZVdpdGhBbmdsZShhbmdsZTogbnVtYmVyKSB7XG4gICAgICBhbmdsZSA9IGFuZ2xlICogKE1hdGguUEkgLyAxODApO1xuICAgICAgdGhpcy5kaXIueCA9IE1hdGguY29zKGFuZ2xlKSAqIHRoaXMudmVsb2NpdHk7XG4gICAgICB0aGlzLmRpci55ID0gLU1hdGguc2luKGFuZ2xlKSAqIHRoaXMudmVsb2NpdHk7XG4gIH1cblxufVxuXG5lbnVtIEdhbWVTdGF0ZSB7XG4gIFJ1bm5pbmcsXG4gIEdhbWVPdmVyXG59XG5cbmVudW0gS2V5Q29kZXMge1xuICBMRUZUID0gMzcsXG4gIFJJR0hUID0gMzlcbn1cblxuY2xhc3MgR2FtZSB7XG4gIGxvb3BJbnRlcnZhbDogbnVtYmVyID0gMTA7XG4gIGdhbWVTdGF0ZTogR2FtZVN0YXRlO1xuICBiYWxsOiBCYWxsO1xuICBwYWRkbGU6IFBhZGRsZTtcbiAgYnJpY2tzOiBBcnJheTxCcmljaz4gPSBbXTtcblxuICBrZXlNYXAgPSB7fTtcblxuICB3YWxsTGVmdCA6IE9ic3RhY2xlO1xuICB3YWxsVG9wOiBPYnN0YWNsZTtcbiAgd2FsbFJpZ2h0OiBPYnN0YWNsZTtcbiAgd2FsbEJvdHRvbTogT2JzdGFjbGU7ICAgIFxuXG4gIGxpdmVzTGVmdCA6IG51bWJlcjtcbiAgc2NvcmU6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihiYWxsRWxlbWVudCA6IEhUTUxFbGVtZW50LCBwYWRkbGU6IEhUTUxFbGVtZW50LCBicmlja3M6IEhUTUxDb2xsZWN0aW9uLCBib2FyZEVsZW1lbnQgOiBIVE1MRWxlbWVudCwgcHVibGljIGxpdmVzTGFiZWwgOiBIVE1MRWxlbWVudCxcbiAgICAgIHB1YmxpYyBzY29yZUxhYmVsOiBIVE1MRWxlbWVudCwgcHVibGljIG5ld0dhbWVCdG46IEhUTUxFbGVtZW50KSB7XG4gICAgICB0aGlzLmdhbWVTdGF0ZSA9IEdhbWVTdGF0ZS5SdW5uaW5nO1xuICAgICAgdGhpcy5wYWRkbGUgPSBuZXcgUGFkZGxlKHBhZGRsZSwgYm9hcmRFbGVtZW50Lm9mZnNldFdpZHRoKTtcblxuICAgICAgdGhpcy5iYWxsID0gbmV3IEJhbGwoXG4gICAgICAgICAgYmFsbEVsZW1lbnQsICAgICAgICAgICAgXG4gICAgICAgICAgbmV3IFZlY3RvcigzLCAtMykgXG4gICAgICApO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJyaWNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuYnJpY2tzLnB1c2gobmV3IEJyaWNrKDxIVE1MRWxlbWVudD5icmlja3NbaV0pKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jcmVhdGVXYWxscyh0aGlzLmJhbGwucmFkaXVzLCBib2FyZEVsZW1lbnQub2Zmc2V0V2lkdGgsIGJvYXJkRWxlbWVudC5vZmZzZXRIZWlnaHQpO1xuXG4gICAgICB0aGlzLm5ld0dhbWUoKTtcblxuICAgICAgdGhpcy5uZXdHYW1lQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5uZXdHYW1lKCkpO1xuICB9ICAgIFxuXG4gIGNyZWF0ZVdhbGxzKHJhZGl1cyA6IG51bWJlciwgbWF4WCA6IG51bWJlciwgbWF4WSA6IG51bWJlcikge1xuICAgICAgdGhpcy53YWxsTGVmdCA9IG5ldyBPYnN0YWNsZSgtcmFkaXVzLCAtcmFkaXVzLCAwLCBtYXhZICsgcmFkaXVzKTtcbiAgICAgIHRoaXMud2FsbFRvcCA9IG5ldyBPYnN0YWNsZSgtcmFkaXVzLCAtcmFkaXVzLCBtYXhYICsgcmFkaXVzLCAwKTtcbiAgICAgIHRoaXMud2FsbFJpZ2h0ID0gbmV3IE9ic3RhY2xlKG1heFgsIC1yYWRpdXMsIG1heFggKyByYWRpdXMsIG1heFkgKyByYWRpdXMpO1xuICAgICAgdGhpcy53YWxsQm90dG9tID0gbmV3IE9ic3RhY2xlKC1yYWRpdXMsIG1heFksIG1heFggKyByYWRpdXMsIG1heFkgKyByYWRpdXMpOyAgICAgICAgXG4gIH1cblxuICBuZXdHYW1lKCkge1xuICAgICAgdGhpcy5uZXdHYW1lQnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB0aGlzLnNjb3JlID0gMDtcbiAgICAgIHRoaXMubGl2ZXNMZWZ0ID0gMztcbiAgICAgIHRoaXMubGl2ZXNMYWJlbC5pbm5lclRleHQgPSAnJyArIHRoaXMubGl2ZXNMZWZ0O1xuICAgICAgdGhpcy5zY29yZSA9IDA7XG4gICAgICB0aGlzLnNjb3JlTGFiZWwuaW5uZXJUZXh0ID0gJycgKyB0aGlzLnNjb3JlO1xuICAgICAgdGhpcy5iYWxsLnNob3coKTtcbiAgICAgIHRoaXMuYmFsbC5ib3VuY2VXaXRoQW5nbGUoNjApO1xuICAgICAgdmFyIGJhbGxQb3NpdGlvbiA9IHRoaXMuYmFsbC5jbG9uZSgpO1xuICAgICAgYmFsbFBvc2l0aW9uLm1vdmVDZW50ZXJYVG8odGhpcy5wYWRkbGUuY2VudGVyWCgpKTtcbiAgICAgIGJhbGxQb3NpdGlvbi5tb3ZlQm90dG9tVG8odGhpcy5wYWRkbGUudG9wTGVmdC55IC0gNCk7XG4gICAgICB0aGlzLmJhbGwubW92ZVRvKGJhbGxQb3NpdGlvbik7XG4gICAgICB0aGlzLmdhbWVTdGF0ZSA9IEdhbWVTdGF0ZS5SdW5uaW5nO1xuICB9XG5cbiAgbG9zdExpdmUoKSB7XG4gICAgICBpZiAoLS10aGlzLmxpdmVzTGVmdCkge1xuICAgICAgICAgIHRoaXMuYmFsbC5ib3VuY2VXaXRoQW5nbGUoNjApO1xuICAgICAgICAgIHZhciBiYWxsUG9zaXRpb24gPSB0aGlzLmJhbGwuY2xvbmUoKTtcbiAgICAgICAgICBiYWxsUG9zaXRpb24ubW92ZUNlbnRlclhUbyh0aGlzLnBhZGRsZS5jZW50ZXJYKCkpO1xuICAgICAgICAgIGJhbGxQb3NpdGlvbi5tb3ZlQm90dG9tVG8odGhpcy5wYWRkbGUudG9wTGVmdC55IC0gNCk7XG4gICAgICAgICAgdGhpcy5iYWxsLm1vdmVUbyhiYWxsUG9zaXRpb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmdhbWVTdGF0ZSA9IEdhbWVTdGF0ZS5HYW1lT3ZlcjtcbiAgICAgICAgICB0aGlzLmJhbGwuaGlkZSgpOyAgICAgICAgICBcbiAgICAgICAgICB0aGlzLm5ld0dhbWVCdG4uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7ICBcbiAgICAgIH1cbiAgICAgIHRoaXMubGl2ZXNMYWJlbC5pbm5lclRleHQgPSAnJyArIHRoaXMubGl2ZXNMZWZ0O1xuICB9XG5cbiAgcnVuKCkge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoZSkgPT4gdGhpcy5rZXlNYXBbZS5rZXlDb2RlXSA9IGZhbHNlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gdGhpcy5rZXlNYXBbZS5rZXlDb2RlXSA9IHRydWUpO1xuXG4gICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5nYW1lU3RhdGUgIT09IEdhbWVTdGF0ZS5SdW5uaW5nKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIG5ld0JhbGxQb3NpdGlvbiA9IHRoaXMuYmFsbC5jYWxjdWxhdGVOZXdQb3NpdGlvbigpO1xuXG4gICAgICAgICAgaWYgKHRoaXMua2V5TWFwW0tleUNvZGVzLkxFRlRdKSB7XG4gICAgICAgICAgICAgIHRoaXMucGFkZGxlLm1vdmVMZWZ0KDUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5rZXlNYXBbS2V5Q29kZXMuUklHSFRdKSB7XG4gICAgICAgICAgICAgIHRoaXMucGFkZGxlLm1vdmVSaWdodCg1KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy53YWxsQm90dG9tLmNoZWNrQ29sbGlzaW9uKG5ld0JhbGxQb3NpdGlvbikpIHtcbiAgICAgICAgICAgICAgdGhpcy5sb3N0TGl2ZSgpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMud2FsbExlZnQuY2hlY2tDb2xsaXNpb24obmV3QmFsbFBvc2l0aW9uKSB8fCB0aGlzLndhbGxSaWdodC5jaGVja0NvbGxpc2lvbihuZXdCYWxsUG9zaXRpb24pKSB7XG4gICAgICAgICAgICAgIHRoaXMuYmFsbC5ib3VuY2VWZXJ0aWNhbCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy53YWxsVG9wLmNoZWNrQ29sbGlzaW9uKG5ld0JhbGxQb3NpdGlvbikpIHtcbiAgICAgICAgICAgICAgdGhpcy5iYWxsLmJvdW5jZUhvcml6b250YWwoKTtcbiAgICAgICAgICB9ICAgICBcblxuICAgICAgICAgIGZvciAobGV0IGJyaWNrIG9mIHRoaXMuYnJpY2tzKSB7XG4gICAgICAgICAgICAgIGxldCB3YXNIaXQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICBzd2l0Y2ggKGJyaWNrLmNoZWNrQ29sbGlzaW9uKG5ld0JhbGxQb3NpdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgIGNhc2UgKFNpZGUuTGVmdCk6XG4gICAgICAgICAgICAgICAgICBjYXNlIChTaWRlLlJpZ2h0KTpcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhbGwuYm91bmNlVmVydGljYWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICB3YXNIaXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICBjYXNlIChTaWRlLlRvcCk6XG4gICAgICAgICAgICAgICAgICBjYXNlIChTaWRlLkJvdHRvbSk6ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhbGwuYm91bmNlSG9yaXpvbnRhbCgpO1xuICAgICAgICAgICAgICAgICAgICAgIHdhc0hpdCA9IHRydWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAod2FzSGl0KSB7XG4gICAgICAgICAgICAgICAgICBicmljay5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlICs9IDIwO1xuICAgICAgICAgICAgICAgICAgdGhpcy5zY29yZUxhYmVsLmlubmVyVGV4dCA9ICcnICsgdGhpcy5zY29yZTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMucGFkZGxlLmNoZWNrQ29sbGlzaW9uKG5ld0JhbGxQb3NpdGlvbikpIHtcbiAgICAgICAgICAgICAgdGhpcy5iYWxsLmJvdW5jZVdpdGhBbmdsZSh0aGlzLnBhZGRsZS5jYWxjdWxhdGVIaXRBbmdsZSh0aGlzLmJhbGwuY2VudGVyWCgpLCB0aGlzLmJhbGwucmFkaXVzKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5iYWxsLm1vdmVUbyh0aGlzLmJhbGwuY2FsY3VsYXRlTmV3UG9zaXRpb24oKSk7XG4gICAgIH0sIHRoaXMubG9vcEludGVydmFsKSBcbiAgfVxufVxuXG5cbnZhciBnYW1lID0gbmV3IEdhbWUoXG4gIDxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYmFsbFwiKVswXSxcbiAgPEhUTUxFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJwYWRkbGVcIilbMF0sXG4gIDxIVE1MQ29sbGVjdGlvbj5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnJpY2tcIiksXG4gIDxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZ2FtZS1ib2FyZFwiKVswXSxcbiAgPEhUTUxFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaXZlcycpLFxuICA8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njb3JlJyksXG4gIDxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3R2FtZScpICAgIFxuKTtcblxuZ2FtZS5ydW4oKTsiXX0=
